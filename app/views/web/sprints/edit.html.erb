<%# Edit Sprint Form %>
<div class="min-h-screen bg-gray-50 py-8">
  <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="bg-white shadow-lg rounded-lg">
      <div class="px-6 py-4 border-b border-gray-200">
        <h1 class="text-2xl font-bold text-gray-900">Edit Sprint</h1>
        <p class="text-gray-600 mt-1">Update sprint details and planning</p>
      </div>
      
      <div class="px-6 py-6">
        <%= form_with model: @sprint, url: sprint_path(@sprint), method: :patch, local: true, 
            class: "space-y-6", data: { controller: "sprint-form" } do |form| %>
          
          <!-- Basic Information -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="md:col-span-2">
              <%= form.label :name, class: "block text-sm font-medium text-gray-700 mb-2" %>
              <%= form.text_field :name, 
                  class: "w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500" %>
              <% if @sprint.errors[:name].any? %>
                <p class="mt-1 text-sm text-red-600"><%= @sprint.errors[:name].first %></p>
              <% end %>
            </div>
            
            <div class="md:col-span-2">
              <%= form.label :goal, "Sprint Goal", class: "block text-sm font-medium text-gray-700 mb-2" %>
              <%= form.text_area :goal, 
                  rows: 3,
                  class: "w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500" %>
            </div>
            
            <div>
              <%= form.label :status, class: "block text-sm font-medium text-gray-700 mb-2" %>
              <%= form.select :status, 
                  options_for_select([
                    ['Planning', 'planning'],
                    ['Active', 'active'],
                    ['Completed', 'completed'],
                    ['Cancelled', 'cancelled']
                  ], @sprint.status),
                  {},
                  class: "w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500" %>
            </div>
            
            <div>
              <%= form.label :milestone_id, "Associated Milestone", class: "block text-sm font-medium text-gray-700 mb-2" %>
              <%= form.select :milestone_id, 
                  options_for_select([['No milestone', '']], @sprint.milestone_id),
                  {},
                  class: "w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500" %>
            </div>
          </div>
          
          <!-- Timeline -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <%= form.label :start_date, class: "block text-sm font-medium text-gray-700 mb-2" %>
              <%= form.date_field :start_date, 
                  class: "w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500" %>
            </div>
            
            <div>
              <%= form.label :end_date, class: "block text-sm font-medium text-gray-700 mb-2" %>
              <%= form.date_field :end_date, 
                  class: "w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500" %>
            </div>
          </div>
          
          <!-- Sprint Planning -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <%= form.label :committed_points, "Committed Story Points", class: "block text-sm font-medium text-gray-700 mb-2" %>
              <%= form.number_field :committed_points, 
                  min: 0,
                  class: "w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500" %>
              <p class="mt-1 text-xs text-gray-500">Total story points the team commits to completing</p>
            </div>
            
            <div>
              <%= form.label :planned_velocity, "Planned Velocity", class: "block text-sm font-medium text-gray-700 mb-2" %>
              <%= form.number_field :planned_velocity, 
                  min: 0,
                  class: "w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500" %>
              <p class="mt-1 text-xs text-gray-500">Expected velocity based on team capacity</p>
            </div>
          </div>
          
          <!-- Current Progress (read-only) -->
          <% if @sprint.status != 'planning' %>
            <div class="border-t border-gray-200 pt-6">
              <h3 class="text-lg font-medium text-gray-900 mb-4">Current Progress</h3>
              <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="bg-gray-50 p-4 rounded-lg text-center">
                  <div class="text-2xl font-bold text-gray-900"><%= @metrics[:completed_tasks] %></div>
                  <div class="text-sm text-gray-600">Completed Tasks</div>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg text-center">
                  <div class="text-2xl font-bold text-blue-600"><%= @sprint.completed_points %></div>
                  <div class="text-sm text-gray-600">Completed Points</div>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg text-center">
                  <div class="text-2xl font-bold text-green-600"><%= @metrics[:completion_percentage] %>%</div>
                  <div class="text-sm text-gray-600">Progress</div>
                </div>
              </div>
            </div>
          <% end %>
          
          <!-- Form Actions -->
          <div class="flex justify-end gap-3 pt-6 border-t border-gray-200">
            <%= link_to sprint_path(@sprint), 
                class: "px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300" do %>
              Cancel
            <% end %>
            
            <%= form.submit "Update Sprint", 
                class: "px-6 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 font-medium" %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>